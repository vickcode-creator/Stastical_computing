# ch6_linear_model.py
import numpy as np
import pandas as pd
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

# simulate data
np.random.seed(0)
X = np.random.rand(100,1) * 10
y = 3.5 * X.squeeze() + 5 + np.random.randn(100) * 2

model = LinearRegression()
model.fit(X, y)
pred = model.predict(X)
print("Coef:", model.coef_, "Intercept:", model.intercept_)
print("MSE:", mean_squared_error(y, pred))

# save results
df = pd.DataFrame({"X": X.squeeze(), "y": y, "yhat": pred})
df.to_csv("linear_model_results.csv", index=False)
print("Saved linear_model_results.csv")
